{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/xiezhendong1/Documents/code/github/zeno/src/utils/parseFund.ts"],"sourcesContent":["interface FundNetWorthPoint {\n  date: string;\n  timestamp: number;\n  nav: number;\n  accNav?: number;\n  changeRate?: number;\n}\n\ninterface FundStockPosition {\n  name: string;\n  code: string;\n  ratio: string;\n}\n\ninterface FundManager {\n  name: string;\n  fundSize: string;\n  fundDate: string;\n}\n\ninterface FundPingzhongData {\n  code: string;\n  type: string;\n  netWorthTrend: FundNetWorthPoint[];\n  accWorthTrend: FundNetWorthPoint[];\n  stockPositions: FundStockPosition[];\n  fundManagers: FundManager[];\n  rankPercent: number | null;\n}\n\nexport function parsePingzhongData(\n  raw: string,\n  code?: string\n): FundPingzhongData {\n  const getVar = (name: string) => {\n    const regex = new RegExp(`var\\\\s+${name}\\\\s*=\\\\s*([^;]+);`);\n    const match = raw.match(regex);\n    if (!match) return undefined;\n    try {\n      return eval('(' + match[1] + ')');\n    } catch {\n      return undefined;\n    }\n  };\n\n  const netWorthTrend = getVar('Data_netWorthTrend') || [];\n  const accWorthTrend = getVar('Data_ACWorthTrend') || [];\n  const stockPositions = getVar('Data_fundSharesPositions') || [];\n  const fundManagers = getVar('Data_currentFundManager') || [];\n  const fundType = getVar('FundType') || '';\n  const rankPercent = getVar('Data_rateInSimilarType') || null;\n\n  // 格式化数据\n  const formatDate = (ts: number) => new Date(ts).toISOString().split('T')[0];\n\n  return {\n    code: code || '',\n    type: fundType,\n    rankPercent,\n    netWorthTrend: netWorthTrend.map((d: any) => ({\n      date: formatDate(d.x),\n      timestamp: d.x,\n      nav: d.y,\n      changeRate: d.equityReturn,\n    })),\n    accWorthTrend: accWorthTrend.map(([x, y]: [number, number]) => ({\n      date: formatDate(x),\n      timestamp: x,\n      accNav: y,\n    })),\n    stockPositions: stockPositions.map((s: any) => ({\n      name: s.stockName,\n      code: s.stockCode,\n      ratio: s.holdRatio,\n    })),\n    fundManagers: fundManagers.map((m: any) => ({\n      name: m.name,\n      fundSize: m.fundSize,\n      fundDate: m.fundDate,\n    })),\n  };\n}\n\nexport default parsePingzhongData;\n"],"names":[],"mappings":";;;;AA8BO,SAAS,mBACd,GAAW,EACX,IAAa;IAEb,MAAM,SAAS,CAAC;QACd,MAAM,QAAQ,IAAI,OAAO,CAAC,OAAO,EAAE,KAAK,iBAAiB,CAAC;QAC1D,MAAM,QAAQ,IAAI,KAAK,CAAC;QACxB,IAAI,CAAC,OAAO,OAAO;QACnB,IAAI;YACF,OAAO,KAAK,MAAM,KAAK,CAAC,EAAE,GAAG;QAC/B,EAAE,OAAM;YACN,OAAO;QACT;IACF;IAEA,MAAM,gBAAgB,OAAO,yBAAyB,EAAE;IACxD,MAAM,gBAAgB,OAAO,wBAAwB,EAAE;IACvD,MAAM,iBAAiB,OAAO,+BAA+B,EAAE;IAC/D,MAAM,eAAe,OAAO,8BAA8B,EAAE;IAC5D,MAAM,WAAW,OAAO,eAAe;IACvC,MAAM,cAAc,OAAO,6BAA6B;IAExD,QAAQ;IACR,MAAM,aAAa,CAAC,KAAe,IAAI,KAAK,IAAI,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IAE3E,OAAO;QACL,MAAM,QAAQ;QACd,MAAM;QACN;QACA,eAAe,cAAc,GAAG,CAAC,CAAC,IAAW,CAAC;gBAC5C,MAAM,WAAW,EAAE,CAAC;gBACpB,WAAW,EAAE,CAAC;gBACd,KAAK,EAAE,CAAC;gBACR,YAAY,EAAE,YAAY;YAC5B,CAAC;QACD,eAAe,cAAc,GAAG,CAAC,CAAC,CAAC,GAAG,EAAoB,GAAK,CAAC;gBAC9D,MAAM,WAAW;gBACjB,WAAW;gBACX,QAAQ;YACV,CAAC;QACD,gBAAgB,eAAe,GAAG,CAAC,CAAC,IAAW,CAAC;gBAC9C,MAAM,EAAE,SAAS;gBACjB,MAAM,EAAE,SAAS;gBACjB,OAAO,EAAE,SAAS;YACpB,CAAC;QACD,cAAc,aAAa,GAAG,CAAC,CAAC,IAAW,CAAC;gBAC1C,MAAM,EAAE,IAAI;gBACZ,UAAU,EAAE,QAAQ;gBACpB,UAAU,EAAE,QAAQ;YACtB,CAAC;IACH;AACF;uCAEe"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/xiezhendong1/Documents/code/github/zeno/src/app/api/pool/price/route.ts"],"sourcesContent":["// 获取 ETF 最新价格\n\nimport { NextResponse } from 'next/server';\nimport parseFund from '@/utils/parseFund';\n\nexport async function GET(request: Request) {\n  const { searchParams } = new URL(request.url);\n  const code = searchParams.get('code');\n\n  if (!code) {\n    return NextResponse.json(\n      { error: 'Code parameter is required' },\n      { status: 400 }\n    );\n  }\n\n  try {\n    const response = await fetch(\n      `https://fund.eastmoney.com/pingzhongdata/${code}.js`\n    );\n\n    if (!response.ok) {\n      return NextResponse.json(\n        { error: 'Failed to fetch fund data' },\n        { status: response.status }\n      );\n    }\n\n    const text = await response.text();\n    const match = text.match(/var Data_netWorthTrend = (\\[.*?\\])/);\n\n    if (!match) {\n      return NextResponse.json(\n        { error: 'Failed to parse fund data' },\n        { status: 500 }\n      );\n    }\n\n    const netWorthData = parseFund(text, code);\n\n    return NextResponse.json(netWorthData);\n  } catch (error) {\n    console.error('Error fetching ETF price:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,cAAc;;;;AAEd;AACA;;;AAEO,eAAe,IAAI,OAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,IAAI,CAAC,MAAM;QACT,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MACrB,CAAC,yCAAyC,EAAE,KAAK,GAAG,CAAC;QAGvD,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,QAAQ,KAAK,KAAK,CAAC;QAEzB,IAAI,CAAC,OAAO;YACV,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe,CAAA,GAAA,2HAAA,CAAA,UAAS,AAAD,EAAE,MAAM;QAErC,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}