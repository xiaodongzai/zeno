{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/xiezhendong1/Documents/code/github/zeno/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\n// 防止在开发环境中创建多个 Prisma Client 实例\n// 在 Next.js 中，由于热重载，可能会创建多个实例\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n\n"],"names":[],"mappings":";;;AAAA;;AAEA,gCAAgC;AAChC,8BAA8B;AAE9B,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///Users/xiezhendong1/Documents/code/github/zeno/src/app/api/pool/route.ts"],"sourcesContent":["// 插入 获取 删除 更新 ETF\n\nimport { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\n// 获取所有 ETF\nexport async function GET(request: Request) {\n  const etfs = await prisma.etf.findMany({\n    orderBy: { updatedAt: 'desc' },\n    select: {\n      id: true,\n      code: true,\n      name: true,\n      category: true,\n      updatedAt: true,\n    },\n    take: 100,\n  });\n  // 获取每个ETF的最新净值估值涨跌幅(gszzl)，返回结构为 jsonpgz(...)\n  await Promise.all(\n    etfs.map(async (etf: any) => {\n      const res = await fetch(`http://fundgz.1234567.com.cn/js/${etf.code}.js`);\n      const text = await res.text();\n      // 返回的格式为 jsonpgz({...});\n      const match = text.match(/jsonpgz\\((.*)\\);/);\n      if (match) {\n        try {\n          const priceObj = JSON.parse(match[1]);\n          etf.change = priceObj.gszzl;\n          etf.price = priceObj.gsz;\n        } catch {\n          etf.change = null;\n          etf.price = null;\n        }\n      }\n    })\n  );\n  return NextResponse.json(etfs);\n}\n\n// 插入 ETF\nexport async function POST(request: Request) {\n  const { code, name, category } = await request.json();\n  if (!code || !name) {\n    return NextResponse.json({ error: 'Invalid ETF data' }, { status: 400 });\n  }\n  const etf = await prisma.etf.create({\n    data: { code, name, category },\n  });\n  return NextResponse.json(etf);\n}\n\n// 删除 ETF - 已移动到 /api/pool/[id] 路由\n"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AAElB;AACA;;;AAGO,eAAe,IAAI,OAAgB;IACxC,MAAM,OAAO,MAAM,sHAAA,CAAA,SAAM,CAAC,GAAG,CAAC,QAAQ,CAAC;QACrC,SAAS;YAAE,WAAW;QAAO;QAC7B,QAAQ;YACN,IAAI;YACJ,MAAM;YACN,MAAM;YACN,UAAU;YACV,WAAW;QACb;QACA,MAAM;IACR;IACA,8CAA8C;IAC9C,MAAM,QAAQ,GAAG,CACf,KAAK,GAAG,CAAC,OAAO;QACd,MAAM,MAAM,MAAM,MAAM,CAAC,gCAAgC,EAAE,IAAI,IAAI,CAAC,GAAG,CAAC;QACxE,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,yBAAyB;QACzB,MAAM,QAAQ,KAAK,KAAK,CAAC;QACzB,IAAI,OAAO;YACT,IAAI;gBACF,MAAM,WAAW,KAAK,KAAK,CAAC,KAAK,CAAC,EAAE;gBACpC,IAAI,MAAM,GAAG,SAAS,KAAK;gBAC3B,IAAI,KAAK,GAAG,SAAS,GAAG;YAC1B,EAAE,OAAM;gBACN,IAAI,MAAM,GAAG;gBACb,IAAI,KAAK,GAAG;YACd;QACF;IACF;IAEF,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;AAC3B;AAGO,eAAe,KAAK,OAAgB;IACzC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;IACnD,IAAI,CAAC,QAAQ,CAAC,MAAM;QAClB,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;IACA,MAAM,MAAM,MAAM,sHAAA,CAAA,SAAM,CAAC,GAAG,CAAC,MAAM,CAAC;QAClC,MAAM;YAAE;YAAM;YAAM;QAAS;IAC/B;IACA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;AAC3B,EAEA,kCAAkC"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}